---
title: "R Notebook"
output: html_notebook
---

```{r}
library(readr)
library(tidyverse)
library(sf)
library(sp)
library(viridis)
library(tigris)
options(tigris_use_cache = T)
```

# Load Data and Add Census Tracts

```{r}
df = read_csv("Final_Cleaned_Data.csv", col_types = cols(GEOID = "c"))
dc_tracts = tracts(state = "DC", cb = T, year = 2022)

df = left_join(df, dc_tracts %>%
                 select(c(GEOID, geometry, ALAND, AWATER)), by = "GEOID")
```

# Plot Data

```{r}
ggplot(data = df) + 
  geom_sf(aes(geometry = geometry, fill = TotalPopulation), color = NA) + 
  scale_fill_viridis(alpha = 0.8) +
  labs(title = "Plot of Total Population", 
       subtitle = "Percentile",
       y = "Longitude", x = "Latitude",
       fill = "Total Population")
```



```{r}
names = names(df[, -c(1, ncol(df))])
for(i in 1:(ncol(df) - 2)) {
  plot = ggplot(data = df) +
    geom_sf(aes(geometry = geometry, fill = !!sym(names[i])), col = NA) + 
    scale_fill_viridis(alpha = 0.9) + 
    labs(x = "Latitude", y = "Longitude",
         title = paste("Plot of", names[i]),
         subtitle = "Percentile")
  ggsave(plot = plot, paste("./plots/", names[i], ".png", sep = ""))
}
```
